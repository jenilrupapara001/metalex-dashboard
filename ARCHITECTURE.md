# ğŸ—ï¸ System Architecture Overview

## Complete Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FRONTEND (React + Vite)                     â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Components (InvoicePage, InvoicesPage, InvoiceForm)          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                           â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Zustand Store (useInvoiceStore)                              â”‚  â”‚
â”‚  â”‚ - State: invoices[], currentInvoice, loading, error          â”‚  â”‚
â”‚  â”‚ - Actions: fetchInvoices, createInvoice, updateInvoice, etc. â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                           â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ API Service Layer (services/apiService.ts)                   â”‚  â”‚
â”‚  â”‚ - InvoiceAPI.create/read/update/delete                       â”‚  â”‚
â”‚  â”‚ - HTTP fetch to backend /api endpoints                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ HTTP Requests
                         â”‚ (Vite proxy: /api â†’ localhost:5000)
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKEND (Express.js)                            â”‚
â”‚                      (Port 5000)                                   â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Express Server (server/index.js)                             â”‚  â”‚
â”‚  â”‚ - CORS middleware                                            â”‚  â”‚
â”‚  â”‚ - JSON body parser                                           â”‚  â”‚
â”‚  â”‚ - Error handling                                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                      â”‚                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Route Handlers (server/routes/)                              â”‚  â”‚
â”‚  â”‚                                                               â”‚  â”‚
â”‚  â”‚  invoices.js:                   clients.js:                 â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ POST / - Create            â”œâ”€â”€ POST / - Create         â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ GET / - List (paginated)   â”œâ”€â”€ GET / - List            â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ GET /:id - Get by ID       â”œâ”€â”€ GET /:id - Get          â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ GET /number/:num - Search  â”œâ”€â”€ PUT /:id - Update       â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ PUT /:id - Update          â””â”€â”€ DELETE /:id - Delete    â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ DELETE /:id - Delete                                    â”‚  â”‚
â”‚  â”‚  â””â”€â”€ PATCH /:id/status - Status                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                      â”‚                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ MongoDB Models (server/models/)                              â”‚  â”‚
â”‚  â”‚                                                               â”‚  â”‚
â”‚  â”‚  Invoice Schema:              Client Schema:                 â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ invoiceNumber (unique)   â”œâ”€â”€ name                       â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ clientName               â”œâ”€â”€ email (unique)             â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ items []                 â”œâ”€â”€ phone                      â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ status (enum)            â”œâ”€â”€ address {}                 â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ subtotal                 â”œâ”€â”€ gstin                      â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ grandTotal               â”œâ”€â”€ pan                        â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ termsAndConditions       â”œâ”€â”€ invoices []               â”‚  â”‚
â”‚  â”‚  â””â”€â”€ timestamps               â””â”€â”€ timestamps                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                      â”‚                                              â”‚
â”‚                      â”‚ Mongoose ODM                                 â”‚
â”‚                      â”‚                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ MongoDB Database                                             â”‚  â”‚
â”‚  â”‚ (localhost:27017 or MongoDB Atlas)                           â”‚  â”‚
â”‚  â”‚                                                               â”‚  â”‚
â”‚  â”‚  Collections:                                                 â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ invoices (indexed: invoiceNumber)                       â”‚  â”‚
â”‚  â”‚  â””â”€â”€ clients (indexed: email)                                â”‚  â”‚
â”‚  â”‚                                                               â”‚  â”‚
â”‚  â”‚  Persistent Storage:                                          â”‚  â”‚
â”‚  â”‚  âœ“ Data survives server restart                              â”‚  â”‚
â”‚  â”‚  âœ“ Data survives browser refresh                             â”‚  â”‚
â”‚  â”‚  âœ“ Data accessible from any client                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## PDF Generation Pipeline

```
User clicks "Download PDF"
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ InvoicePage Component       â”‚
â”‚ - Invoice data              â”‚
â”‚ - PositionPreview images    â”‚
â”‚ - <div id="invoice-preview">â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PDFService.generateInvoicePDF()     â”‚
â”‚                                      â”‚
â”‚ Step 1: Capture with html2canvas    â”‚
â”‚ - Scale: 2x (high quality)          â”‚
â”‚ - Format: PNG                       â”‚
â”‚ - Window: 1024Ã—1400                 â”‚
â”‚                                      â”‚
â”‚ Step 2: Create jsPDF instance       â”‚
â”‚ - Format: A4                        â”‚
â”‚ - Unit: mm                          â”‚
â”‚ - Compression: enabled              â”‚
â”‚                                      â”‚
â”‚ Step 3: Smart Page Breaking         â”‚
â”‚ - Content width: 190mm              â”‚
â”‚ - Content height: 267mm             â”‚
â”‚ - Crop canvas for each page         â”‚
â”‚ - No content cutoff                 â”‚
â”‚                                      â”‚
â”‚ Step 4: Add Images                  â”‚
â”‚ - Position: 10mm margin all sides   â”‚
â”‚ - Size: scale to fit page           â”‚
â”‚ - Format: PNG (lossless)            â”‚
â”‚                                      â”‚
â”‚ Step 5: Output Blob                 â”‚
â”‚ - Format: PDF/blob                  â”‚
â”‚ - Compressed: yes                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Browser Downloads    â”‚
â”‚ - Filename correct   â”‚
â”‚ - Format: PDF        â”‚
â”‚ - Quality: A4 print  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## State Management Flow

```
User Action
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ React Component              â”‚
â”‚ onClick/onChange handlers    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Zustand Store Action                 â”‚
â”‚ - createInvoice(invoice)             â”‚
â”‚ - updateInvoice(id, data)            â”‚
â”‚ - deleteInvoice(id)                  â”‚
â”‚ - fetchInvoices(page, limit)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼ set({ loading: true })
           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ API Service (InvoiceAPI.*)           â”‚
â”‚ - Fetch request to backend           â”‚
â”‚ - Wait for response                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼ POST/PUT/GET/DELETE
           â”‚
         Backend Express
           â†“ Mongoose
         MongoDB
           â”‚
           â–¼ Response JSON
           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Zustand Store Update                 â”‚
â”‚ set({ invoices, loading: false })    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ React Component Re-render            â”‚
â”‚ - Display updated data               â”‚
â”‚ - Show success/error message         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Database Schema Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ _id: ObjectId (unique) â”‚
â”‚ name: String            â”‚
â”‚ email: String (unique)  â”‚
â”‚ phone: String           â”‚
â”‚ address: Object         â”‚
â”‚ gstin: String           â”‚
â”‚ pan: String             â”‚
â”‚ invoices: [Invoice._id] â”‚ â—„â”€â”€â”
â”‚ createdAt: Date         â”‚    â”‚
â”‚ updatedAt: Date         â”‚    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
                               â”‚
                    One-to-Many
                    Relationship
                               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Invoice                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ _id: ObjectId (unique)              â”‚
â”‚ invoiceNumber: String (unique,idx)  â”‚
â”‚ clientId: ObjectId â†’ Client         â”‚
â”‚ clientName: String (indexed)        â”‚
â”‚ date: Date                          â”‚
â”‚ preparedBy: String                  â”‚
â”‚ status: Enum (draft/sent/accepted)  â”‚
â”‚ items: [Object] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚   â”œâ”€â”€ id: String             â”‚      â”‚
â”‚   â”œâ”€â”€ position: Number       â”‚      â”‚
â”‚   â”œâ”€â”€ quantity: Number       â”‚      â”‚
â”‚   â”œâ”€â”€ description: String    â”‚      â”‚
â”‚   â”œâ”€â”€ areaSqft: Number       â”‚      â”‚
â”‚   â”œâ”€â”€ pricePerSqft: Number   â”‚      â”‚
â”‚   â”œâ”€â”€ total: Number          â”‚      â”‚
â”‚   â”œâ”€â”€ technicalDetails: {}   â”‚      â”‚
â”‚   â””â”€â”€ remarks: String        â”‚      â”‚
â”œâ”€ Many Items per Invoice â”€â”€â”€â”€â”˜      â”‚
â”‚ subtotal: Number                    â”‚
â”‚ freight: Number                     â”‚
â”‚ tax: Number                         â”‚
â”‚ grandTotal: Number                  â”‚
â”‚ termsAndConditions: [String]        â”‚
â”‚ notes: String                       â”‚
â”‚ createdAt: Date                     â”‚
â”‚ updatedAt: Date                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## API Request/Response Flow

```
CLIENT REQUEST:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

POST /api/invoices
Content-Type: application/json

{
  "invoiceNumber": "INV-2024-001",
  "clientName": "Acme Corp",
  "clientAddress": "123 Main St",
  "items": [...],
  "grandTotal": 50000,
  ...
}

SERVER PROCESSING:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Express receives request
2. CORS middleware validates
3. JSON parser converts body
4. Route handler: POST /api/invoices
5. Mongoose schema validation
6. MongoDB save operation
7. Auto-generate _id and timestamps

SERVER RESPONSE:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

201 Created
{
  "success": true,
  "data": {
    "_id": "507f1f77bcf86cd799439011",
    "invoiceNumber": "INV-2024-001",
    "clientName": "Acme Corp",
    "createdAt": "2024-01-09T10:30:00Z",
    "updatedAt": "2024-01-09T10:30:00Z",
    ...
  }
}

FRONTEND HANDLING:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. API service receives response
2. Parse JSON body
3. Extract data
4. Update Zustand store
5. Trigger React re-render
6. UI shows success message
```

---

## Error Handling Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Error Occurs in Any Layer              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                â”‚              â”‚              â”‚
     â–¼                â–¼              â–¼              â–¼
Frontend API    Mongoose       Express      MongoDB
Validation      Schema         Middleware   Error
     â”‚          Error          Error        
     â”‚                â”‚              â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Error Response (400/500) â”‚
        â”‚ {                        â”‚
        â”‚   success: false,        â”‚
        â”‚   error: "message"       â”‚
        â”‚ }                        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Frontend Catches Error   â”‚
        â”‚ - Zustand: error = msg   â”‚
        â”‚ - UI shows error toast   â”‚
        â”‚ - logging: disabled      â”‚
        â”‚ - User can retry         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Deployment Architecture (Future)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Production Environment                â”‚
â”‚                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Frontend (Vercel/Netlify)              â”‚   â”‚
â”‚  â”‚ - React/Vite SPA                       â”‚   â”‚
â”‚  â”‚ - CDN edge caching                     â”‚   â”‚
â”‚  â”‚ - Auto-HTTPS                          â”‚   â”‚
â”‚  â”‚ - CI/CD from GitHub                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                 â”‚ HTTPS                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Backend (Heroku/Railway/Digital Ocean) â”‚   â”‚
â”‚  â”‚ - Express.js                           â”‚   â”‚
â”‚  â”‚ - Node.js runtime                      â”‚   â”‚
â”‚  â”‚ - Environment variables                â”‚   â”‚
â”‚  â”‚ - Auto-scaling                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                 â”‚ SSL/TLS                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Database (MongoDB Atlas)                â”‚   â”‚
â”‚  â”‚ - Cloud-hosted MongoDB                 â”‚   â”‚
â”‚  â”‚ - Automatic backups                    â”‚   â”‚
â”‚  â”‚ - Replica sets                         â”‚   â”‚
â”‚  â”‚ - Point-in-time recovery               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## File Structure Overview

```
metalex-saas/
â”œâ”€â”€ Frontend (React + Vite)
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ InvoicePage.tsx          â† Main page with Download button
â”‚   â”‚   â”œâ”€â”€ InvoicePreview.tsx       â† A4-ready PDF template
â”‚   â”‚   â”œâ”€â”€ InvoicesPage.tsx         â† List all invoices
â”‚   â”‚   â”œâ”€â”€ InvoiceForm.tsx          â† Create/edit form
â”‚   â”‚   â””â”€â”€ ... (other components)
â”‚   â”‚
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ apiService.ts            â† HTTP client for API
â”‚   â”‚   â”œâ”€â”€ pdfService.ts            â† PDF generation with proper formatting
â”‚   â”‚   â””â”€â”€ geminiService.ts         â† AI/Gemini integration
â”‚   â”‚
â”‚   â”œâ”€â”€ stores/
â”‚   â”‚   â””â”€â”€ invoiceStore.ts          â† Zustand state management
â”‚   â”‚
â”‚   â”œâ”€â”€ types.ts                     â† TypeScript interfaces
â”‚   â”œâ”€â”€ index.tsx                    â† Entry point
â”‚   â””â”€â”€ ... (config, constants, styles)
â”‚
â”œâ”€â”€ Backend (Express + MongoDB)
â”‚   â”œâ”€â”€ server/
â”‚   â”‚   â”œâ”€â”€ index.js                 â† Express server entry
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”‚   â”œâ”€â”€ Invoice.js           â† MongoDB Invoice schema
â”‚   â”‚   â”‚   â””â”€â”€ Client.js            â† MongoDB Client schema
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ routes/
â”‚   â”‚       â”œâ”€â”€ invoices.js          â† Invoice CRUD endpoints
â”‚   â”‚       â””â”€â”€ clients.js           â† Client CRUD endpoints
â”‚   â”‚
â”‚   â””â”€â”€ .env.local                   â† MongoDB URI config
â”‚
â”œâ”€â”€ Configuration
â”‚   â”œâ”€â”€ vite.config.ts               â† Vite with API proxy
â”‚   â”œâ”€â”€ tsconfig.json                â† TypeScript config
â”‚   â”œâ”€â”€ tailwind.config.ts           â† Tailwind CSS
â”‚   â””â”€â”€ package.json                 â† Dependencies & scripts
â”‚
â”œâ”€â”€ Documentation
â”‚   â”œâ”€â”€ QUICKSTART.md                â† Get running in 5 min
â”‚   â”œâ”€â”€ BACKEND_SETUP.md             â† Detailed backend setup
â”‚   â”œâ”€â”€ CHANGES_SUMMARY.md           â† What changed
â”‚   â””â”€â”€ DEPLOYMENT.md                â† Production deployment
â”‚
â””â”€â”€ Git
    â”œâ”€â”€ .git/
    â”œâ”€â”€ .gitignore
    â””â”€â”€ Remote: https://github.com/jenilrupapara001/metalex-dashboard
```

---

**System Complexity**: Medium âš–ï¸
**Scalability**: High (MongoDB Atlas can handle 1M+ documents)
**Maintainability**: High (Modular architecture, clear separation of concerns)
**Production Ready**: âœ… Yes
